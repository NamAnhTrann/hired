<section>
  @if (product) {
    <div class="p-4">
      <div class="mt-24 max-w-[1800px] mx-auto px-4">
        <div
          class="grid items-start grid-cols-1 lg:grid-cols-2 gap-8 max-lg:gap-12 max-sm:gap-8"
        >
          <div class="w-full lg:sticky top-24 self-start">
            <div class="flex flex-col gap-4">
              <div class="p-2">
                <img
                  [src]="selectedImage"
                  [alt]="product.product_title"
                  class="w-full aspect-[11/8] object-cover object-top transition-opacity duration-200"
                />
              </div>

              <div class="rounded-xl px-4 py-4 w-full">
                <div
                  class="flex gap-3 overflow-x-auto pb-2 sm:grid sm:grid-cols-5 sm:gap-4 sm:overflow-visible"
                >
                  @for (img of product.product_image; track $index) {
                    <button
                      type="button"
                      class="group shrink-0 sm:shrink w-24 sm:w-full"
                      (click)="selectedImage = img"
                    >
                      <img
                        [src]="img"
                        class="w-full aspect-square object-cover rounded-lg transition-all duration-200 hover:scale-[1.03]"
                      />
                    </button>
                  }
                </div>
              </div>
            </div>
          </div>

          <div class="w-full">
            <p class="text-lg font-medium leading-8 text-indigo-600 mb-4">
              {{ product.product_category | titlecase }}
            </p>
            <div>
              <h3 class="text-lg sm:text-xl font-semibold text-slate-900">
                {{ product.product_title }}
              </h3>
              <div class="flex items-center gap-3 mt-2">
                <div class="flex items-center gap-1">
                  <p class="text-base text-slate-500">4</p>
                  <svg
                    class="w-3.5 h-3.5 fill-indigo-600"
                    viewBox="0 0 14 13"
                    fill="none"
                    xmlns="http://www.w3.org/2000/svg"
                  >
                    <path
                      d="M7 0L9.4687 3.60213L13.6574 4.83688L10.9944 8.29787L11.1145 12.6631L7 11.2L2.8855 12.6631L3.00556 8.29787L0.342604 4.83688L4.5313 3.60213L7 0Z"
                    />
                  </svg>
                  <svg
                    class="w-3.5 h-3.5 fill-indigo-600"
                    viewBox="0 0 14 13"
                    fill="none"
                    xmlns="http://www.w3.org/2000/svg"
                  >
                    <path
                      d="M7 0L9.4687 3.60213L13.6574 4.83688L10.9944 8.29787L11.1145 12.6631L7 11.2L2.8855 12.6631L3.00556 8.29787L0.342604 4.83688L4.5313 3.60213L7 0Z"
                    />
                  </svg>
                  <svg
                    class="w-3.5 h-3.5 fill-indigo-600"
                    viewBox="0 0 14 13"
                    fill="none"
                    xmlns="http://www.w3.org/2000/svg"
                  >
                    <path
                      d="M7 0L9.4687 3.60213L13.6574 4.83688L10.9944 8.29787L11.1145 12.6631L7 11.2L2.8855 12.6631L3.00556 8.29787L0.342604 4.83688L4.5313 3.60213L7 0Z"
                    />
                  </svg>
                  <svg
                    class="w-3.5 h-3.5 fill-indigo-600"
                    viewBox="0 0 14 13"
                    fill="none"
                    xmlns="http://www.w3.org/2000/svg"
                  >
                    <path
                      d="M7 0L9.4687 3.60213L13.6574 4.83688L10.9944 8.29787L11.1145 12.6631L7 11.2L2.8855 12.6631L3.00556 8.29787L0.342604 4.83688L4.5313 3.60213L7 0Z"
                    />
                  </svg>
                  <svg
                    class="w-3.5 h-3.5 fill-[#CED5D8]"
                    viewBox="0 0 14 13"
                    fill="none"
                    xmlns="http://www.w3.org/2000/svg"
                  >
                    <path
                      d="M7 0L9.4687 3.60213L13.6574 4.83688L10.9944 8.29787L11.1145 12.6631L7 11.2L2.8855 12.6631L3.00556 8.29787L0.342604 4.83688L4.5313 3.60213L7 0Z"
                    />
                  </svg>
                </div>
                <span class="text-slate-500">|</span>
                <p class="text-sm">
                  <i class="fa-solid fa-lightbulb"></i> 10/10
                </p>
                <span class="text-slate-500">|</span>
                <p class="text-sm text-slate-500">
                  <i class="fa-solid fa-comment"></i>
                  {{ product.comment_count }}
                </p>
                <span class="text-slate-500">|</span>
                <button
                  (click)="toggleLikeProduct(product)"
                  class="flex items-center gap-2 text-indigo-700 font-semibold"
                >
                  <span>
                    @if (product.liked_by_user) {
                      <i class="fa-solid fa-heart"></i>
                    } @else {
                      â™¡
                    }
                  </span>
                  <span>{{ product.like_count }}</span>
                </button>
              </div>
              <div class="flex items-center flex-wrap gap-2 mt-6">
                <h4 class="text-indigo-800 text-2xl sm:text-3xl font-semibold">
                  {{
                    product.product_price
                      | currency: "AUD" : "symbol" : "1.2-2" : "en-AU"
                  }}
                </h4>

                <!-- <div class="flex py-1 px-2 bg-indigo-600 font-semibold !ml-4">
                  <span class="text-white text-sm">save 10%</span>
                </div> -->
              </div>

              <div>
                <!-- <h4 class="text-base mt-4 text-slate-500 font-semibold">
                  Net Wt: 100G
                </h4> -->
              </div>
            </div>

            <hr class="my-6 border-gray-300" />

            <!-- <div>
              <h3 class="text-lg sm:text-xl font-semibold text-slate-900">
                Sizes
              </h3>
              <div class="mb-4 flex flex-wrap gap-4 mt-4">
                <button
                  type="button"
                  class="w-10 h-9 border border-slate-300 hover:border-slate-600 text-sm cursor-pointer flex items-center justify-center shrink-0"
                >
                  SM
                </button>
                <button
                  type="button"
                  class="w-10 h-9 border border-slate-600 hover:border-slate-600 text-sm cursor-pointer flex items-center justify-center shrink-0"
                >
                  MD
                </button>
                <button
                  type="button"
                  class="w-10 h-9 border border-slate-300 hover:border-slate-600 text-sm cursor-pointer flex items-center justify-center shrink-0"
                >
                  LG
                </button>
                <button
                  type="button"
                  class="w-10 h-9 border border-slate-300 hover:border-slate-600 text-sm cursor-pointer flex items-center justify-center shrink-0"
                >
                  XL
                </button>
              </div>
            </div> -->
            <div>
              <div
                class="flex gap-4 items-center border border-gray-300 bg-white px-4 py-2.5 w-max"
              >
                <!-- DECREASE -->
                <button
                  type="button"
                  class="border-0 outline-0 cursor-pointer"
                  (click)="quantity = quantity > 1 ? quantity - 1 : 1"
                >
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    class="w-2.5 h-2.5"
                    viewBox="0 0 121.805 121.804"
                  >
                    <path
                      d="M7.308 68.211h107.188a7.309 7.309 0 0 0 7.309-7.31 7.308 7.308 0 0 0-7.309-7.309H7.308a7.31 7.31 0 0 0 0 14.619z"
                    />
                  </svg>
                </button>

                <!-- QUANTITY -->
                <span class="text-slate-900 text-sm font-semibold px-6 block">
                  {{ quantity }}
                </span>

                <!-- INCREASE -->
                <button
                  type="button"
                  class="border-0 outline-0 cursor-pointer"
                  (click)="quantity = quantity + 1"
                >
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    class="w-2.5 h-2.5"
                    viewBox="0 0 512 512"
                  >
                    <path
                      d="M256 509.892c-19.058 0-34.5-15.442-34.5-34.5V36.608c0-19.058 15.442-34.5 34.5-34.5s34.5 15.442 34.5 34.5v438.784c0 19.058-15.442 34.5-34.5 34.5z"
                    />
                    <path
                      d="M475.392 290.5H36.608c-19.058 0-34.5-15.442-34.5-34.5s15.442-34.5 34.5-34.5h438.784c19.058 0 34.5 15.442 34.5 34.5s-15.442 34.5-34.5 34.5z"
                    />
                  </svg>
                </button>
              </div>

              <!-- ADD TO CART -->
              <div class="mt-4 flex flex-wrap gap-4">
                <!-- ADD TO CART (PRIMARY) -->
                <button
                  type="button"
                  (click)="add_cart(product._id, quantity)"
                  class="px-5 py-3 w-full sm:w-[48%] bg-indigo-600 hover:bg-indigo-700 text-white text-sm font-medium rounded-lg transition"
                >
                  Add to cart
                </button>

                <!-- BACK TO MARKETPLACE (SECONDARY) -->
                <button
                  type="button"
                  routerLink="/marketplace-page"
                  class="px-5 py-3 w-full sm:w-[48%] border border-slate-300 text-slate-700 text-sm font-medium rounded-lg hover:bg-slate-50 transition"
                >
                  Back to Shopping
                </button>
              </div>
            </div>

            <hr class="my-6 border-slate-300" />
            <div class="max-w-4xl space-y-16">
              <!-- PRODUCT INFORMATION -->
              <section class="space-y-6">
                <h3 class="text-xl font-semibold text-slate-900">
                  Product Information
                </h3>

                <p class="text-base text-slate-600 leading-relaxed">
                  {{ product.product_description }}
                </p>

                <ul
                  class="grid grid-cols-1 sm:grid-cols-2 gap-x-8 gap-y-4 text-base text-slate-800"
                >
                  <li class="flex items-start gap-3">
                    <i class="fa-solid fa-circle-check"></i>
                    <span>High-quality materials with durable stitching</span>
                  </li>

                  <li class="flex items-start gap-3">
                    <i class="fa-solid fa-circle-check"></i>
                    <span>Comfortable fit designed for everyday wear</span>
                  </li>

                  <li class="flex items-start gap-3">
                    <i class="fa-solid fa-circle-check"></i>
                    <span>Easy to maintain and machine washable</span>
                  </li>

                  <li class="flex items-start gap-3">
                    <i class="fa-solid fa-circle-check"></i>
                    <span>Suitable for casual and semi-formal use</span>
                  </li>
                </ul>
              </section>

              <!-- SHIPPING INFORMATION -->
              <section class="space-y-6">
                <h3 class="text-xl font-semibold text-slate-900">
                  Shipping & Delivery
                </h3>

                <div
                  class="grid grid-cols-1 sm:grid-cols-2 gap-y-6 gap-x-10 text-sm"
                >
                  <div class="flex items-start gap-3">
                    <i class="fa-solid fa-truck-fast"></i>
                    <div>
                      <p class="text-slate-500">Ships from</p>
                      <p class="font-medium text-slate-900">Australia</p>
                    </div>
                  </div>

                  <div class="flex items-start gap-3">
                    <i class="fa-solid fa-clock"></i>
                    <div>
                      <p class="text-slate-500">Estimated delivery</p>
                      <p class="font-medium text-slate-900">
                        2â€“5 business days
                      </p>
                    </div>
                  </div>

                  <div class="flex items-start gap-3">
                    <i class="fa-solid fa-plane-departure"></i>
                    <div>
                      <p class="text-slate-500">Tracking</p>
                      <p class="font-medium text-slate-900">
                        Provided after dispatch
                      </p>
                    </div>
                  </div>

                  <div class="flex items-start gap-3">
                    <i class="fa-solid fa-arrow-rotate-left"></i>
                    <div>
                      <p class="text-slate-500">Returns</p>
                      <p class="font-medium text-slate-900">
                        Free within 14 days
                      </p>
                    </div>
                  </div>
                </div>
              </section>
            </div>

            <div
              class="mt-10 rounded-xl border border-slate-200 bg-white overflow-hidden"
            >
              <button
                type="button"
                routerLink="/profile-page"
                class="group w-full px-6 py-5 text-left transition hover:bg-slate-50"
              >
                <!-- Top row -->
                <div class="flex items-center">
                  <span class="text-sm font-semibold text-slate-900">
                    Vendor details
                  </span>

                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    class="w-3.5 h-3.5 ml-auto text-slate-400 transition-transform group-hover:translate-x-0.5"
                    viewBox="0 0 24 24"
                    fill="currentColor"
                  >
                    <path
                      fill-rule="evenodd"
                      d="M12 18.17a2.38 2.38 0 0 1-1.68-.7l-9.52-9.52a2.38 2.38 0 1 1 3.36-3.36L12 12.41l7.84-7.84a2.38 2.38 0 1 1 3.36 3.36l-9.52 9.52a2.38 2.38 0 0 1-1.68.7z"
                      clip-rule="evenodd"
                    />
                  </svg>
                </div>

                <!-- Description -->
                <p class="mt-2 text-sm text-slate-600 leading-relaxed">
                  View seller profile, ratings, and other products from this
                  vendor.
                </p>
              </button>
            </div>

            <hr class="my-6 border-slate-300" />

            <div>
              <!-- COMMENT INPUT AREA -->
              <div
                class="mt-6 bg-white border border-gray-200 rounded-xl p-5 shadow-sm"
              >
                <!-- HEADER -->
                <div class="flex items-center justify-between mb-3">
                  <p class="text-sm font-semibold text-slate-900">
                    Write a review
                  </p>
                  <span class="text-xs text-slate-400">
                    Be respectful and honest
                  </span>
                </div>

                <!-- TEXTAREA -->
                <textarea
                  [(ngModel)]="newComment[product._id]"
                  placeholder="What did you like or dislike about this product?"
                  class="w-full min-h-[120px] border border-gray-300 rounded-lg p-4 text-sm resize-none focus:outline-none focus:border-indigo-500 focus:ring-2 focus:ring-indigo-500/30 transition"
                ></textarea>

                <!-- ACTIONS -->
                <div class="flex items-center justify-between mt-4">
                  <p class="text-xs text-slate-400">
                    Your comment will be public
                  </p>

                  <button
                    (click)="postComment(product._id)"
                    class="px-6 py-2 bg-indigo-600 hover:bg-indigo-700 text-white text-sm font-semibold rounded-lg transition active:scale-95"
                  >
                    Post Comment
                  </button>
                </div>
              </div>
            </div>

            <div class="mt-6 space-y-6">
              @for (c of comments[product._id]?.slice(0, 5); track c._id) {
                <div class="flex items-start">
                  <img
                    src="https://readymadeui.com/team-2.webp"
                    class="w-12 h-12 rounded-full border-2 border-white"
                  />

                  <div class="ml-3 flex-1">
                    <h4 class="text-slate-900 text-sm font-semibold">
                      {{ c.user.username }}
                    </h4>

                    <p class="text-xs text-slate-500 mt-1">
                      {{ c.createdAt | date: "mediumDate" }}
                    </p>

                    <p class="text-sm text-slate-500 mt-3 leading-relaxed">
                      {{ c.text }}
                    </p>
                  </div>
                </div>
              }

              <!-- READ MORE -->
              @if (comments[product._id]?.length > 5) {
                <button
                  (click)="openCommentsModal(product._id)"
                  class="text-indigo-600 hover:underline text-sm font-semibold"
                >
                  Read more...
                </button>
              }
            </div>
          </div>
        </div>

        <hr class="my-6 border-slate-300" />
        <section>
          <h2 class="text-3xl font-semibold text-gray-900 mb-8">
            Suggested Products
          </h2>

          <div class="grid sm:grid-cols-2 lg:grid-cols-4 gap-5">
            <!-- PRODUCT CARD -->
            <div
              class="rounded-xl bg-white p-3 hover:-translate-y-1 transition-all duration-200"
            >
              <a href="#">
                <div
                  class="relative w-full pb-[130%] overflow-hidden rounded-lg mb-3"
                >
                  <img
                    src="https://readymadeui.com/images/sunscreen-img-1.webp"
                    alt="SunProtect Sunscreen SPF"
                    class="absolute inset-0 w-full h-full object-cover transition duration-300 hover:scale-105"
                  />
                </div>

                <h3
                  class="font-semibold text-gray-900 text-base leading-tight line-clamp-2"
                >
                  SunProtect Sunscreen SPF 50+ PA+++
                </h3>

                <p class="text-blue-600 font-bold text-lg mt-1">$12</p>
                <div class="flex items-center gap-3 mt-2">
                  <div class="flex items-center gap-1">
                    <p class="text-base text-slate-500">4</p>
                    <svg
                      class="w-3.5 h-3.5 fill-indigo-600"
                      viewBox="0 0 14 13"
                      fill="none"
                      xmlns="http://www.w3.org/2000/svg"
                    >
                      <path
                        d="M7 0L9.4687 3.60213L13.6574 4.83688L10.9944 8.29787L11.1145 12.6631L7 11.2L2.8855 12.6631L3.00556 8.29787L0.342604 4.83688L4.5313 3.60213L7 0Z"
                      />
                    </svg>
                    <svg
                      class="w-3.5 h-3.5 fill-indigo-600"
                      viewBox="0 0 14 13"
                      fill="none"
                      xmlns="http://www.w3.org/2000/svg"
                    >
                      <path
                        d="M7 0L9.4687 3.60213L13.6574 4.83688L10.9944 8.29787L11.1145 12.6631L7 11.2L2.8855 12.6631L3.00556 8.29787L0.342604 4.83688L4.5313 3.60213L7 0Z"
                      />
                    </svg>
                    <svg
                      class="w-3.5 h-3.5 fill-indigo-600"
                      viewBox="0 0 14 13"
                      fill="none"
                      xmlns="http://www.w3.org/2000/svg"
                    >
                      <path
                        d="M7 0L9.4687 3.60213L13.6574 4.83688L10.9944 8.29787L11.1145 12.6631L7 11.2L2.8855 12.6631L3.00556 8.29787L0.342604 4.83688L4.5313 3.60213L7 0Z"
                      />
                    </svg>
                    <svg
                      class="w-3.5 h-3.5 fill-indigo-600"
                      viewBox="0 0 14 13"
                      fill="none"
                      xmlns="http://www.w3.org/2000/svg"
                    >
                      <path
                        d="M7 0L9.4687 3.60213L13.6574 4.83688L10.9944 8.29787L11.1145 12.6631L7 11.2L2.8855 12.6631L3.00556 8.29787L0.342604 4.83688L4.5313 3.60213L7 0Z"
                      />
                    </svg>
                    <svg
                      class="w-3.5 h-3.5 fill-[#CED5D8]"
                      viewBox="0 0 14 13"
                      fill="none"
                      xmlns="http://www.w3.org/2000/svg"
                    >
                      <path
                        d="M7 0L9.4687 3.60213L13.6574 4.83688L10.9944 8.29787L11.1145 12.6631L7 11.2L2.8855 12.6631L3.00556 8.29787L0.342604 4.83688L4.5313 3.60213L7 0Z"
                      />
                    </svg>
                  </div>
                  <span class="text-slate-500">|</span>
                  <p class="text-sm text-yellow-500">ðŸ’¡ 10/10</p>
                  <span class="text-slate-500">|</span>
                  <p class="text-sm text-slate-500">50 comments</p>
                </div>
              </a>
            </div>

            <!-- PRODUCT CARD -->
            <div
              class="rounded-xl bg-white p-3 hover:-translate-y-1 transition-all duration-200"
            >
              <a href="#">
                <div
                  class="relative w-full pb-[130%] overflow-hidden rounded-lg mb-3"
                >
                  <img
                    src="https://readymadeui.com/images/sunscreen-img-2.webp"
                    alt="Hydrating Face Cream"
                    class="absolute inset-0 w-full h-full object-cover transition duration-300 hover:scale-105"
                  />
                </div>

                <h3
                  class="font-semibold text-gray-900 text-base leading-tight line-clamp-2"
                >
                  Hydrating Face Cream with Vitamin E
                </h3>

                <p class="text-blue-600 font-bold text-lg mt-1">$18</p>
                <div class="flex items-center gap-3 mt-2">
                  <div class="flex items-center gap-1">
                    <p class="text-base text-slate-500">4</p>
                    <svg
                      class="w-3.5 h-3.5 fill-indigo-600"
                      viewBox="0 0 14 13"
                      fill="none"
                      xmlns="http://www.w3.org/2000/svg"
                    >
                      <path
                        d="M7 0L9.4687 3.60213L13.6574 4.83688L10.9944 8.29787L11.1145 12.6631L7 11.2L2.8855 12.6631L3.00556 8.29787L0.342604 4.83688L4.5313 3.60213L7 0Z"
                      />
                    </svg>
                    <svg
                      class="w-3.5 h-3.5 fill-indigo-600"
                      viewBox="0 0 14 13"
                      fill="none"
                      xmlns="http://www.w3.org/2000/svg"
                    >
                      <path
                        d="M7 0L9.4687 3.60213L13.6574 4.83688L10.9944 8.29787L11.1145 12.6631L7 11.2L2.8855 12.6631L3.00556 8.29787L0.342604 4.83688L4.5313 3.60213L7 0Z"
                      />
                    </svg>
                    <svg
                      class="w-3.5 h-3.5 fill-indigo-600"
                      viewBox="0 0 14 13"
                      fill="none"
                      xmlns="http://www.w3.org/2000/svg"
                    >
                      <path
                        d="M7 0L9.4687 3.60213L13.6574 4.83688L10.9944 8.29787L11.1145 12.6631L7 11.2L2.8855 12.6631L3.00556 8.29787L0.342604 4.83688L4.5313 3.60213L7 0Z"
                      />
                    </svg>
                    <svg
                      class="w-3.5 h-3.5 fill-indigo-600"
                      viewBox="0 0 14 13"
                      fill="none"
                      xmlns="http://www.w3.org/2000/svg"
                    >
                      <path
                        d="M7 0L9.4687 3.60213L13.6574 4.83688L10.9944 8.29787L11.1145 12.6631L7 11.2L2.8855 12.6631L3.00556 8.29787L0.342604 4.83688L4.5313 3.60213L7 0Z"
                      />
                    </svg>
                    <svg
                      class="w-3.5 h-3.5 fill-[#CED5D8]"
                      viewBox="0 0 14 13"
                      fill="none"
                      xmlns="http://www.w3.org/2000/svg"
                    >
                      <path
                        d="M7 0L9.4687 3.60213L13.6574 4.83688L10.9944 8.29787L11.1145 12.6631L7 11.2L2.8855 12.6631L3.00556 8.29787L0.342604 4.83688L4.5313 3.60213L7 0Z"
                      />
                    </svg>
                  </div>
                  <span class="text-slate-500">|</span>
                  <p class="text-sm text-yellow-500">ðŸ’¡ 10/10</p>
                  <span class="text-slate-500">|</span>
                  <p class="text-sm text-slate-500">50 comments</p>
                </div>
              </a>
            </div>

            <!-- PRODUCT CARD -->
            <div
              class="rounded-xl bg-white p-3 hover:-translate-y-1 transition-all duration-200"
            >
              <a href="#">
                <div
                  class="relative w-full pb-[130%] overflow-hidden rounded-lg mb-3"
                >
                  <img
                    src="https://readymadeui.com/images/sunscreen-img-3.webp"
                    alt="Daily Moisturizer"
                    class="absolute inset-0 w-full h-full object-cover transition duration-300 hover:scale-105"
                  />
                </div>

                <h3
                  class="font-semibold text-gray-900 text-base leading-tight line-clamp-2"
                >
                  Daily Moisturizer for Sensitive Skin
                </h3>

                <p class="text-blue-600 font-bold text-lg mt-1">$15</p>
                <div class="flex items-center gap-3 mt-2">
                  <div class="flex items-center gap-1">
                    <p class="text-base text-slate-500">4</p>
                    <svg
                      class="w-3.5 h-3.5 fill-indigo-600"
                      viewBox="0 0 14 13"
                      fill="none"
                      xmlns="http://www.w3.org/2000/svg"
                    >
                      <path
                        d="M7 0L9.4687 3.60213L13.6574 4.83688L10.9944 8.29787L11.1145 12.6631L7 11.2L2.8855 12.6631L3.00556 8.29787L0.342604 4.83688L4.5313 3.60213L7 0Z"
                      />
                    </svg>
                    <svg
                      class="w-3.5 h-3.5 fill-indigo-600"
                      viewBox="0 0 14 13"
                      fill="none"
                      xmlns="http://www.w3.org/2000/svg"
                    >
                      <path
                        d="M7 0L9.4687 3.60213L13.6574 4.83688L10.9944 8.29787L11.1145 12.6631L7 11.2L2.8855 12.6631L3.00556 8.29787L0.342604 4.83688L4.5313 3.60213L7 0Z"
                      />
                    </svg>
                    <svg
                      class="w-3.5 h-3.5 fill-indigo-600"
                      viewBox="0 0 14 13"
                      fill="none"
                      xmlns="http://www.w3.org/2000/svg"
                    >
                      <path
                        d="M7 0L9.4687 3.60213L13.6574 4.83688L10.9944 8.29787L11.1145 12.6631L7 11.2L2.8855 12.6631L3.00556 8.29787L0.342604 4.83688L4.5313 3.60213L7 0Z"
                      />
                    </svg>
                    <svg
                      class="w-3.5 h-3.5 fill-indigo-600"
                      viewBox="0 0 14 13"
                      fill="none"
                      xmlns="http://www.w3.org/2000/svg"
                    >
                      <path
                        d="M7 0L9.4687 3.60213L13.6574 4.83688L10.9944 8.29787L11.1145 12.6631L7 11.2L2.8855 12.6631L3.00556 8.29787L0.342604 4.83688L4.5313 3.60213L7 0Z"
                      />
                    </svg>
                    <svg
                      class="w-3.5 h-3.5 fill-[#CED5D8]"
                      viewBox="0 0 14 13"
                      fill="none"
                      xmlns="http://www.w3.org/2000/svg"
                    >
                      <path
                        d="M7 0L9.4687 3.60213L13.6574 4.83688L10.9944 8.29787L11.1145 12.6631L7 11.2L2.8855 12.6631L3.00556 8.29787L0.342604 4.83688L4.5313 3.60213L7 0Z"
                      />
                    </svg>
                  </div>
                  <span class="text-slate-500">|</span>
                  <p class="text-sm text-yellow-500">ðŸ’¡ 10/10</p>
                  <span class="text-slate-500">|</span>
                  <p class="text-sm text-slate-500">50 comments</p>
                </div>
              </a>
            </div>

            <!-- PRODUCT CARD -->
            <div
              class="rounded-xl bg-white p-3 hover:-translate-y-1 transition-all duration-200"
            >
              <a href="#">
                <div
                  class="relative w-full pb-[130%] overflow-hidden rounded-lg mb-3"
                >
                  <img
                    src="https://readymadeui.com/images/sunscreen-img-4.webp"
                    alt="Aloe Vera Gel"
                    class="absolute inset-0 w-full h-full object-cover transition duration-300 hover:scale-105"
                  />
                </div>

                <h3
                  class="font-semibold text-gray-900 text-base leading-tight line-clamp-2"
                >
                  Aloe Vera Cooling Gel for Skin Repair
                </h3>

                <p class="text-blue-600 font-bold text-lg mt-1">$10</p>
                <div class="flex items-center gap-3 mt-2">
                  <div class="flex items-center gap-1">
                    <p class="text-base text-slate-500">4</p>
                    <svg
                      class="w-3.5 h-3.5 fill-indigo-600"
                      viewBox="0 0 14 13"
                      fill="none"
                      xmlns="http://www.w3.org/2000/svg"
                    >
                      <path
                        d="M7 0L9.4687 3.60213L13.6574 4.83688L10.9944 8.29787L11.1145 12.6631L7 11.2L2.8855 12.6631L3.00556 8.29787L0.342604 4.83688L4.5313 3.60213L7 0Z"
                      />
                    </svg>
                    <svg
                      class="w-3.5 h-3.5 fill-indigo-600"
                      viewBox="0 0 14 13"
                      fill="none"
                      xmlns="http://www.w3.org/2000/svg"
                    >
                      <path
                        d="M7 0L9.4687 3.60213L13.6574 4.83688L10.9944 8.29787L11.1145 12.6631L7 11.2L2.8855 12.6631L3.00556 8.29787L0.342604 4.83688L4.5313 3.60213L7 0Z"
                      />
                    </svg>
                    <svg
                      class="w-3.5 h-3.5 fill-indigo-600"
                      viewBox="0 0 14 13"
                      fill="none"
                      xmlns="http://www.w3.org/2000/svg"
                    >
                      <path
                        d="M7 0L9.4687 3.60213L13.6574 4.83688L10.9944 8.29787L11.1145 12.6631L7 11.2L2.8855 12.6631L3.00556 8.29787L0.342604 4.83688L4.5313 3.60213L7 0Z"
                      />
                    </svg>
                    <svg
                      class="w-3.5 h-3.5 fill-indigo-600"
                      viewBox="0 0 14 13"
                      fill="none"
                      xmlns="http://www.w3.org/2000/svg"
                    >
                      <path
                        d="M7 0L9.4687 3.60213L13.6574 4.83688L10.9944 8.29787L11.1145 12.6631L7 11.2L2.8855 12.6631L3.00556 8.29787L0.342604 4.83688L4.5313 3.60213L7 0Z"
                      />
                    </svg>
                    <svg
                      class="w-3.5 h-3.5 fill-[#CED5D8]"
                      viewBox="0 0 14 13"
                      fill="none"
                      xmlns="http://www.w3.org/2000/svg"
                    >
                      <path
                        d="M7 0L9.4687 3.60213L13.6574 4.83688L10.9944 8.29787L11.1145 12.6631L7 11.2L2.8855 12.6631L3.00556 8.29787L0.342604 4.83688L4.5313 3.60213L7 0Z"
                      />
                    </svg>
                  </div>
                  <span class="text-slate-500">|</span>
                  <p class="text-sm text-yellow-500">ðŸ’¡ 10/10</p>
                  <span class="text-slate-500">|</span>
                  <p class="text-sm text-slate-500">50 comments</p>
                </div>
              </a>
            </div>
          </div>
        </section>
      </div>
    </div>
  }
</section>
@if (showCommentsModal) {
  <div
    class="fixed inset-0 z-[9999] bg-black/50 flex items-center justify-center px-4"
  >
    <div
      class="bg-white w-full max-w-2xl max-h-[80vh] rounded-xl shadow-xl overflow-hidden"
    >
      <!-- HEADER -->
      <div class="flex items-center justify-between px-6 py-4 border-b">
        <h3 class="text-lg font-semibold text-slate-900">
          All Customer Comments
        </h3>

        <button
          (click)="closeCommentsModal()"
          class="text-slate-500 hover:text-slate-800 text-xl leading-none"
        >
          Ã—
        </button>
      </div>

      <!-- BODY -->
      <div class="p-6 overflow-y-auto space-y-6">
        @for (c of comments[activeCommentsProductId!]; track c._id) {
          <div class="flex items-start">
            <img
              src="https://readymadeui.com/team-2.webp"
              class="w-10 h-10 rounded-full"
            />

            <div class="ml-3 flex-1">
              <h4 class="text-sm font-semibold text-slate-900">
                {{ c.user.username }}
              </h4>

              <p class="text-xs text-slate-500 mt-1">
                {{ c.createdAt | date: "mediumDate" }}
              </p>

              <p class="text-sm text-slate-600 mt-3 leading-relaxed">
                {{ c.text }}
              </p>
            </div>
          </div>
        }
      </div>
    </div>
  </div>
}
